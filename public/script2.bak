// Fetch data from the API endpoint
fetch("/api/data")
  .then((response) => response.json())
  .then((result) => {
    // Handle the result on the client side
    displayResult(result);
  })
  .catch((error) => {
    console.error("Error:", error);
    document.getElementById("result-container").textContent =
      "Error fetching result from server";
  });

function displayResult(result) {
  const resultContainer = document.getElementById("result-container");
  resultContainer.innerHTML = `<pre>${formatJson(result)}</pre>`;
}

function formatJson(json) {
  return JSON.stringify(json, null, 2)
    .replace(/&/g, "&amp;")
    .replace(/</g, "&lt;")
    .replace(/>/g, "&gt;")
    .replace(
      /"(\\u[a-f0-9]{4}|\\[^\\"]|[^\\"])*"(\s*:)?(\s*[,\}])/g,
      function (match) {
        const propertyStyle = match.includes(":")
          ? 'class="property-name"'
          : "";
        const valueStyle = match.includes(":")
          ? 'class="property-value"'
          : 'class="property-string"';
        return `<span ${propertyStyle}>${match}</span>${
          match.includes(":") ? "" : "<br>"
        }`;
      }
    );
}
