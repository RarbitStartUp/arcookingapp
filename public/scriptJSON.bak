// Wrap the code in a window load event listener
window.addEventListener("load", () => {
  // Fetch data from the API endpoint
  fetch("/api/data")
    .then((response) => {
      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
      return response.json();
    })
    .then((result) => {
      // Log the entire result object to the console
      console.log(result);

      // Display the checklist in the result container
      displayChecklist(result);
    })
    .catch((error) => {
      console.error("Error fetching result from server:", error);
      document.getElementById("result-container").textContent =
        "Error fetching result from server";
    });

  function displayChecklist(result) {
    const resultContainer = document.getElementById("result-container");

    // Example: Apply different styles based on JSON data
    if (
      result.parts &&
      Array.isArray(result.parts) &&
      result.parts.length > 0 &&
      result.parts[0].text
    ) {
      resultContainer.style.backgroundColor = "lightgreen";

      try {
        // Log the raw JSON-formatted string within the "text" property
        console.log("Raw JSON data:", result.parts[0].text);

        // Display the raw JSON text without additional formatting
        resultContainer.innerHTML = `
          <pre>${result.parts[0].text}</pre>
        `;
      } catch (parseError) {
        console.error("Error displaying JSON:", parseError);
        resultContainer.textContent = "Error displaying JSON data.";
      }
    } else {
      resultContainer.style.backgroundColor = "lightcoral";
      resultContainer.textContent = "Invalid or missing data in the response.";
    }
  }
});
